{% extends "tcms_base.html" %}

{% load extra_filters %}
{% load pagination_tags %}

{% block subtitle %}Test cases{% endblock %}

{% block custom_stylesheet %}
{% endblock %}
{% block custom_javascript %}
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablekit/fastinit.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablekit/tablekit.js"></script>
<script type="text/javascript" src='{{ MEDIA_URL }}/js/testcase_actions.js'></script>
<script type="text/javascript">
Nitrate.Utils.after_page_load(Nitrate.TestCases.List.on_load);
</script>
{% endblock %}
{% block contents %}
<div id="content">
	<div class="sprites crumble">
		<a href="{% url tcms.core.views.index %}">Home</a> >>
		{% if query_result %}
		<a href="{% url tcms.testcases.views.all %}">Search Cases</a> >> Search result
		{% else %}
		Search Cases
		{% endif %}
	</div>
	<form action="{% url tcms.testcases.views.all %}" method="get">
		<div id="itemSearch" class="itemSearch">
			<h2>Search Case</h2>
			{% include "case/form/search.html" %}
			<div class='clear'></div>
			<div class="bottom" >
				<input type="submit" size="7" name="a" value="search" name="" title="Search test case" />
				<input type="reset" size="7" value="Reset" name="" title="Reset the search keyword" />
			</div>
		</div>
	</form>
	<!--case list-->
	{% if test_cases %}
	{% autopaginate test_cases %}
	<form id="cases_form" action="{% url tcms.testcases.views.clone %}" method="post">
	<div id="contentTab" class="mixbar">
		{#}<span class="tit">{{ test_cases.count }} Cases</span>{#}
		<span>
			{% if perms.testcases.add_testcase %}
			<input type="submit" value="Clone" title="clone selected test plans" />
			{% endif %}
			<input type="button" value="Printable copy" title="Create the printable copy for selected cases." onclick="postToURL('{% url tcms.testcases.views.printable %}', this.form.serialize(true))" />
			<input type="button" value="Export" title="Export the cases for selected cases." onclick="postToURL('{% url tcms.testcases.views.export %}', this.form.serialize(true))" />
		</span> 
		{% paginate %}
	</div>
	<table class="list border-bottom" id="testcases_table" cellpadding="0" cellspacing="0" border="0">
		<thead>
			<tr>
				<th width="18px">
					<a id="id_blind_all_link">
						<img src="{{ MEDIA_URL }}/images/t1.gif" border="0" alt="" class="collapse-all">
					</a>
				</th>
				<th width="20" class="nosort">
					<input type="checkbox" id="id_checkbox_all_case" title="Select all/Select none">
				</th>
				<th width="50"><span></span>ID</th>
				<th><span></span>Summary</th>
				<th width="100"><span></span>Author</th>
				<th width="130"><span></span>Default Tester</th>
				<th width="140"><span></span>Automated</th>
				<th width="90" ><span></span>Status</th>
				<th width="120"><span></span>Category</th>
				<th width="60"><span></span>Priority</th>
				<th width="140" colspan='2'><span></span>Created</th>
			</tr>
		</thead>
		<tbody>
			{% for test_case in test_cases %}
			<tr class="case_title {% cycle 'odd' 'even' %}">
				<td class="expandable">
					<img class="expand blind_icon" src="{{ MEDIA_URL }}/images/t1.gif" border="0" alt="">
				</td>
				<td valign="top"><input type="checkbox" name="case" value="{{ test_case.case_id }}"></td>
				<td valign="top"><a href="{% url tcms.testcases.views.get test_case.case_id %}">{{ test_case.case_id }}</a></td>
				<td valign="top" class="expandable"><a id="link_{{ test_case.case_id }}" href="{% url tcms.testcases.views.get test_case.case_id %}">{{ test_case.summary }}</a></td>
				<td valign="top"><a href="{% url tcms.profiles.views.profile test_case.author.username %}">{{ test_case.author }}</a></td>
				<td valign="top">{% if test_case.default_tester_id %}<a href="{% url tcms.profiles.views.profile test_case.default_tester.username %}">{{ test_case.default_tester }}</a>{% else %}None{% endif %}</td>
				<td valign="top">{{ test_case.get_is_automated_status }}</td>
				<td valign="top">{{ test_case.case_status }}</td>
				<td valign="top">{{ test_case.category }}</td>
				<td valign="top" align="center">{{ test_case.priority }}</td>
				<td valign="top" colspan='2'>{{ test_case.create_date }}</td>
			</tr>
			
			<tr class="case_content hide" style="display: none;">
				<td colspan="11">
					<div id="id_loading_{{ test_case.pk }}" class="ajax_loading"></div>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	{% paginate %}
	</form>
	{% else %}
	{% ifequal REQUEST_CONTENTS.a 'search' %}
	<span class="prompt-message"><center>No test case found</center></span>
	{% endifequal %}
	{% endif %}
</div>
{% endblock %}
