{% extends "tcms_base.html" %}

{% block subtitle %}{{ test_plan.name }}{% endblock %}

{% block custom_stylesheet %}
<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}/style/print.css" media="print" />
{% endblock %}
{% block custom_javascript %}
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablesort/fastinit.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablesort/tablesort.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablekit/tablekit.js"></script>
<script type="text/javascript" src='{{ MEDIA_URL }}/js/lib/tablednd.js'></script>
<script type="text/javascript" src="{{ MEDIA_URL }}/js/testplan_actions.js"></script>
<script type="text/javascript" src='{{ MEDIA_URL }}/js/testcase_actions.js'></script>
<script type="text/javascript" src="/admin/jsi18n/"></script>
<script type="text/javascript" src="{{ ADMIN_MEDIA_PREFIX }}js/core.js"></script>
<script type="text/javascript" src="{{ ADMIN_MEDIA_PREFIX }}js/SelectFilter2.js"></script>
<script type="text/javascript" src="{{ ADMIN_MEDIA_PREFIX }}js/SelectBox.js"></script>

<script type="text/javascript">
Nitrate.Utils.after_page_load(Nitrate.TestPlans.Details.on_load);

Nitrate.TestPlans.Instance = {
	pk: {{ test_plan.pk }},
	product_id: {{ test_plan.product_id }},
	author_id: {{ test_plan.author_id }},
}
</script>

{% endblock %}
{% block contents %}
<div id="content">
	<div class="sprites crumble">
		<a href="{% url tcms.core.views.index %}">Home</a>
		>> <a href="{% url tcms.testplans.views.all %}">Planning</a>
		>> {{ test_plan.plan_id }}: {{ test_plan.name }}
	</div>
	<input id="id_plan_id" type="hidden" name="plan_id" value="{{ test_plan.plan_id }}">
	<div class="control">
		<span id="id_buttons" class="button">
			<input id="btn_edit" type="button" value="Edit plan " title="Edit test plan" onclick="window.location.href='{% url tcms.testplans.views.edit test_plan.plan_id %}'" {% if perms.testplans.change_testplan %}{% else%}disabled{% endif %}>
			<input id="btn_clone" type="button" value="Clone plan" title="Clone this plan to other product" onclick="window.location.href='{% url tcms.testplans.views.clone %}?plan_id={{ test_plan.plan_id }}'" {% if perms.testplans.add_testplan %}{% else %}disabled{% endif %}>
            {% if test_plan.is_active %}
            <input id="btn_disable" type="button" value="Disable plan " title="Disabled this plan" {% if not perms.testplans.change_testplan %}disabled="true"{% endif %}>
            {% else %}
            <input id="btn_enable" type="button" value="Enable plan " title="Enabled this plan" {% if not perms.testplans.change_testplan %}disabled="true"{% endif %}>
            {% endif %}
			{% comment %}
			<input id="btn_report" type="button" value="Report " title="" onclick="window.location.href='{% url tcms.testplans.views.report test_plan.plan_id %}'">
			{% endcomment %}
			<input id="btn_export" type="button" value="Export all cases " title="Export all cases to XML file" onclick="window.location.href='{% url tcms.testplans.views.export test_plan.plan_id %}'">
            
			<span class="right-action">
				<img src="{{ MEDIA_URL}}/images/icon_printer.png" width="16px">
				<a href="{% url tcms.testplans.views.printable test_plan.plan_id %}">Print Plan</a>
			</span>
		</span>
	</div>
	<h2 id="display_title" class="{% ifequal test_plan.is_active 0 %}line-through{% endifequal %}">
		{{ test_plan.name }}
	</h2>
	<div class="listinfo_content">
		<div class="leftlistinfo">
			<div class="listinfo">
				<div class="title">Author</div>
				<div id="display_author"  class="name " > <a href="mailto:{{ test_plan.author.email }}">{{ test_plan.author.email }}</a></div>
			</div>
			<div class="listinfo">
				<div class="title">Product</div>
				<div id="display_product"><a href="{% url tcms.testplans.views.all %}?product_id={{ test_plan.product_id }}" title="Search plans of {{ test_plan.product }} ">{{ test_plan.product }}</a></div>
			</div>
			<div class="listinfo">
				<div class="title">Version</div>
				<div id="display_product_version">{{ test_plan.default_product_version }}</div>
			</div>
			<div class="listinfo">
				<div class="title">Plan Type</div>
				<div id="display_type">{{ test_plan.type.name }}</div>
			</div>
         </div>
        <div class="rightlistinfo">
			<div class="listinfo">
				<div class="title">Environment Group</div>
				<div class="name">
					{% for env_group in test_plan.env_group.all %}
					<span class="blue strong"><a href="{% url tcms.testplans.views.all %}?env_group_id={{ env_group.id }}" title="Search plans of use {{ env_group.name }} ">{{ env_group.name }}</a></span>
					{% endfor %}
				</div>
				<div id="display_summary" >
					{% for env_property in env_properties %}
					{{ env_property.property.name }},
					{% endfor %}
				</div>
			</div>
			<div class="listinfo">
				<div class="title">Reference Link</div>
				<div class="name">
					{% if test_plan.extra_link %}
					<a href="{{ test_plan.extra_link }}">{{ test_plan.extra_link }}</a>
					{% else %}
					None
					{% endif %}
				</div>
			</div>
            <div class="listinfo">
            	<div class="title">Create Time</div>
                {{test_plan.create_date}}
                
            </div>
		</div>
        <div class="clear"></div>
	</div>
	<div id="plan_detail">
	<div class="Detailform border-1">
		<ul id="contentTab" class="content_tab">
			<li id="tab_document" class="tab">
				<a href="#document" title="document">Document</a>
			</li>
			<li id="tab_testcases" class="tab tab_focus">
				<a href="#testcases" title="testcases">Cases ({{ test_plan.case.count }})</a>
			</li>
			<li id="tab_testruns"  class="tab">
				<a href="#testruns" title="testruns">Runs ({{ test_plan.run.count }} )</a>
			</li>
			<li id="tab_testreviews"  class="tab">
				<a href="#testreviews" title="testreviews">Reviews ({{ test_plan.review.count }})</a>
			</li>
			<li id="tab_components"  class="tab">
				<a href="#components" title="components">Default Components ({{ test_plan.component.count }})</a>
			</li>
			<li id="tab_attachment" class="tab">
				<a href="#attachment" title="attachment">Attachments ({{ test_plan.attachment.count }})</a>
			</li>
			<li id="tab_tag" class="tab">
				<a href="#tag" title="tag">Tags ({{ test_plan.tag.count }})</a>
			</li>
			<li id="tab_tag" class="tab">
				<a href="#log" title="log">Log</a>
			</li>
            <li id="tab_treeview" class="tab">
                <a href="#treeview" title="treeview">Tree View</a>
            </li>
		</ul>
		<div class="tab_list" id="document" style="display:none">
			{% include "plan/get_docs.html" %}
		</div>
		<div class="tab_list" id="attachment" style="display:none">
			{% include "plan/get_attachments.html" %}
		</div>
		<div class="tab_list" id="testruns"  style="display:none;">
			{% include "plan/get_runs.html" %}
		</div>
		<div class="tab_list" id="testreviews"  style="display:none;">
			{% include "plan/get_reviews.html" %}
		</div>
		<div class="tab_list" id="components"  style="display:none;">
			<div class="ajax_loading"></div>
		</div>
		<div class="tab_list" id="log"  style="display:none;">
			{% include "plan/get_log.html" %}
		</div>
        <div class="tab_list" id="treeview"  style="display:none;">
            {% include "plan/get_treeview.html" %}
        </div>
		<div id="testcases"  class="tab_list">
			<div class="ajax_loading"></div>
		</div>
		<div class="tab_list" id="tag" style="display:none">
			<div class="ajax_loading"></div>
		</div>
	</div>
	</div>
</div>
{% endblock %}
