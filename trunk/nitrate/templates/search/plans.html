{% load pagination_tags %}
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablekit/fastinit.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}/js/lib/tablekit/tablekit.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}/js/testplan_actions.js"></script>
<script type="text/javascript" src="/admin/jsi18n/"></script>
<script type="text/javascript" src="{{ ADMIN_MEDIA_PREFIX }}js/core.js"></script>
<script type="text/javascript" src="{{ ADMIN_MEDIA_PREFIX }}js/calendar.js"></script>
<script type="text/javascript" src="{{ ADMIN_MEDIA_PREFIX }}js/admin/DateTimeShortcuts.js"></script>

<script type="text/javascript">
Nitrate.Utils.after_page_load(Nitrate.TestPlans.List.on_load);
</script>

<form id="plans_form">
	{% autopaginate test_plans %}
	<div id="contentTab" class="mixbar">
		{#<span class="tit">{{ test_plans.count }} Plans</span>#}
		<span>
			{% if perms.testplans.add_testplan %}
			<input type="button" title="Create new test plan" value="New Test Plan" onclick="window.location='{% url tcms.testplans.views.new %}'" />
			<input type="button" value="Clone" title="clone selected test plans." onclick="postToURL('{% url tcms.testplans.views.clone %}', this.form.serialize(true), 'get')" />
			{% endif %}
			<input type="button" value="Printable copy" title="Create the printable copy for selected plans." onclick="postToURL('{% url tcms.testcases.views.printable %}', this.form.serialize(true))" />
			<input type="button" value="Export" title="Export the cases for selected plans." onclick="postToURL('{% url tcms.testcases.views.export %}', this.form.serialize(true))" />
		</span>
		
		<span class="right-action">
			{% paginate %}
			{% comment %}
			Add Column
			<select id="column_add">
				<option></option>
				<option id="col_product_option" value="col_product">Product</option>
				<option id="col_product_veresion_option" value="col_product_version">Product Version</option>
			</select>
			{% endcomment %}
		</span>
		
	</div>
	<table id="testplans_table" class="list border-bottom" cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;">
		<thead>
			<tr>
				<th width="20" class="nosort"><input id="id_check_all_plans" type="checkbox" title="Select all/Select none" /></th>
				<th width="50" class="number" title="Sort by plan ID"><span></span>ID</th>
				<th class="text" title="Sort by plan name"><span></span>Name</th>
				<th width="100" class="text" title="Sort by author"><span></span>Author</th>
				<th width="180" class="text" title="Sort by product name" id="col_product_head"><span></span>Product</th>
				<th width="120" class="sortable" title="Sort by product version" style="display:none" id="col_product_version_head"><span></span>Product Version</th>
				<th width="140" class="text" title="Sort by plan type"><span></span>Type</th>
				<th width="50" class="number" title="Sort by number of test cases"><span></span>Cases</th>
				<th width="40" class="number" title="Sort by number of test runs"><span></span>Runs</th>
				<th class="nosort" align="left" width="80"><span></span>Actions</th>
			</tr>
		</thead>
		
		<tbody>
			{% for test_plan in test_plans %}
			<tr class="{% if not test_plan.is_active %}line-through inactive{% endif %}">
				<td><input type="checkbox" name="plan" value="{{ test_plan.pk }}" title="Select/Unselect"></td>
				<td class="{% if not test_plan.is_active %}underline{% endif %}"><a href="{% url tcms.testplans.views.get test_plan.plan_id %}">{{ test_plan.plan_id }}</a></td>
				<td class="{% if not test_plan.is_active %}underline{% endif %}"><a href="{% url tcms.testplans.views.get test_plan.plan_id %}" title="Go to {{ test_plan.name }}">{{ test_plan }} </a></td>
				<td><a href="{% url tcms.profiles.views.profile test_plan.author.username %}">{{ test_plan.author }}</a></td>
				<td class="col_product_content">{{ test_plan.product }}</td>
				<td style="display:none" class="col_product_version_content">{{ test_plan.default_product_version }}</td>
				<td>{{ test_plan.type }}</td>
				<td><a href="{% url tcms.testplans.views.get test_plan.plan_id %}" title="{{ test_plan.num_cases }} test cases">{{ test_plan.num_cases }}</a></td>
				<td><a href="{% url tcms.testplans.views.get test_plan.plan_id %}#testruns" title="{{ test_plan.num_runs }} test runs">{{ test_plan.num_runs }}</a></td>
				<td>
					{% if perms.testplans.change_testplan %}
					<a class="editlink" href="{% url tcms.testplans.views.edit test_plan.plan_id %}">Edit</a>
					{% endif %}
				</td>
			</tr>
			{% empty %}
			<tr>
				<td colspan="9">No test plans found.</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
{% paginate %}
</form>
